# add_tags.py - скрипт для добавления тегов к книгам
from main import Book, Session, engine, select

# Примерный словарь "название книги -> теги". Вы можете и должны его изменить!
book_tags_map = {
    "Изучаем Python": ["мотивация", "учеба", "развитие", "практика"],
    "Чистый код": ["профессионализм", "качество", "структура", "лучшие практики"],
    "Автостопом по галактике": ["юмор", "приключения", "философия", "абсурд"],
    "1984": ["антиутопия", "политика", "контроль", "размышления"],
    "Мастер и Маргарита": ["мистика", "сатира", "добро и зло", "классика"],
    "Три товарища": ["дружба", "любовь", "потеря", "меланхолия"],
    "Маленький принц": ["философия", "дети", "дружба", "простые истины"]
}

with Session(engine) as session:
    # Получаем все книги из базы
    books = session.exec(select(Book)).all()
    for book in books:
        # Если для этой книги есть теги в нашем словаре - добавляем их
        if book.title in book_tags_map:
            book.tags = book_tags_map[book.title]
            print(f"Добавлены теги для '{book.title}': {book.tags}")
        else:
            # Если нет - ставим пустой список (или можете придумать свои)
            book.tags = []
            print(f"Для '{book.title}' теги не найдены, установлен пустой список.")
    # Сохраняем изменения в базе
    session.commit()
print("Все теги успешно добавлены!")